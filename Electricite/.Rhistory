somme = rep(0,8)
somme[1] = Data[1,1]*(coef(reg)[1,1+1]-Beta_0[1])
somme[2] = Data[i,2]*(coef(reg)[1,2+1]-Beta_0[2])
somme[3] = Data[i,3]*(coef(reg)[1,3+1]-Beta_0[3])
somme[4] = Data[i,4]*(coef(reg)[1,4+1]-Beta_0[4])
somme[8] = Data[i,8]*(coef(reg)[1,8+1]-Beta_0[8])
somme
sum(somme)**2
somme_j = rep(0,100)
somme_j[1] = sum(somme)**2
Data[120,8]
Data[20,8]
View(Data)
for (i in 1:dim(Data)[1]){
somme_j = rep(0,100)
for (j in 1:dim(Data)[2]-1){
somme = rep(0,8)
somme[j] = Data[i,j]*(coef(reg)[1,j+1]-Beta_0[j])
}
somme_j[i] = sum(somme)**2
}
for (i in 1:20){
somme_i = rep(0,100)
for (j in 1:8){
somme = rep(0,8)
somme[j] = Data[i,j]*(coef(reg)[1,j+1]-Beta_0[j])
}
somme_i[i] = sum(somme)**2
}
somme_i
for (i in 1:20){
somme_i = rep(0,100)
for (j in 1:8){
somme = rep(0,8)
somme[j] = Data[i,j]*(coef(reg)[1,j+1]-Beta_0[j])
}
somme_i[i] = sum(somme)**2
}
somme
somme_i = rep(0,100)
for (i in 1:20){
for (j in 1:8){
somme = rep(0,8)
somme[j] = Data[i,j]*(coef(reg)[1,j+1]-Beta_0[j])
}
somme_i[i] = sum(somme)**2
}
somme_i = rep(0,100)
for (i in 1:20){
somme = rep(0,8)
for (j in 1:8){
somme[j] = Data[i,j]*(coef(reg)[1,j+1]-Beta_0[j])
}
somme_i[i] = sum(somme)**2
}
somme_i
somme_i = rep(0,20)
for (i in 1:20){
somme = rep(0,8)
for (j in 1:8){
somme[j] = Data[i,j]*(coef(reg)[1,j+1]-Beta_0[j])
}
somme_i[i] = sum(somme)**2
}
somme_i
norme = sum(somme_i)
norme = rep(0,100)
for (lambda in 1:100){
somme_i = rep(0,20)
for (i in 1:20){
somme = rep(0,8)
for (j in 1:8){
somme[j] = Data[i,j]*(coef(reg)[lambda,j+1]-Beta_0[j])
}
somme_i[i] = sum(somme)**2
}
norme[lambda] = sum(somme_i)
}
matplot((1:100)/100,norme,type="l",xlab="Valeur de lambda",ylab="Norme 2")
matplot((1:100)/100,norme,type="l",xlab="Valeur de lambda",ylab="Valeur de la fonction f(lambda)")
library(lasso2)
Data = read.csv("/Users/admin/Desktop/ENSAE/2A/S1/Stat 1/DM/Data_sujet6.csv",sep=";")
reg = l1ce(Data[,9] ~ ., Data[,1:8],bound=(1:100)/100)
graph_coef = plot(reg)
gcv(reg)
lambda_opt=gcv(reg)[which.min(gcv(reg)[,"gcv"]),"rel.bound"]
print(lambda_opt)
library(cvlasso)
install.packages("cvlasso")
install.packages("cvlasso", dependencies=TRUE, repos='http://cran.rstudio.com/')
install.packages("cvlasso", repos="http://cran.cnr.berkeley.edu")
library(hdi)
install.packages("hdi")
library(hdi)
install.packages("glmnet")
install.packages("glmnet", repos="http://cran.cnr.berkeley.edu")
install.packages("glmnet",repo="http://cran.stat.ucla.edu/")
library(glmnet)
Data = read.csv("W:/Bureau/Data_sujet6.csv",sep=";")
summary(Data)
Data = read.csv("/Users/admin/Desktop/ENSAE/2A/S1/Stat 1/DM/Data_sujet6.csv",sep=";")
summary(Data)
install.packages("glmnetUtils")
install.packages("glmnet")
install.packages("glmnetUtils")
library(glmnet)
Data = read.csv("/Users/admin/Desktop/ENSAE/2A/S1/Stat 1/DM/Data_sujet6.csv", sep=";")
seq(0, 1, len = 11)^3
cva.glmnet(as.matrix(Data[,1:8]),as.matrix(Data[,9]), alpha = seq(0, 1, len = 11)^3, nfolds = 3)
library(glmnetUtils)
cva.glmnet(as.matrix(Data[,1:8]),as.matrix(Data[,9]), alpha = seq(0, 1, len = 11)^3, nfolds = 3)
cv_EN = cva.glmnet(as.matrix(Data[,1:8]),as.matrix(Data[,9]), alpha = seq(0, 1, len = 11)^3, nfolds = 3)
plot(cv_EN)
minlossplot(cv_EN)
cv_EN = cva.glmnet(as.matrix(Data[,1:8]),as.matrix(Data[,9]), alpha = c(1:100)/100, nfolds = 3)
minlossplot(cv_EN)
plot(cv_EN)
library(caret)
install.packages(caret)
install.packages("caret")
library(caret)
cv_5 = trainControl(method = "cv", number = 5)
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
library(caret)
library(ggplot2)
install.packages(rlang)
install.packages("rlang")
install.packages("rlang")
library(rlang)
install.packages("rlang")
install.packages("rlang")
library(rlang)
install.packages("rlang")
library(caret)
install.packages("recipes")
library(recipes)
library(caret)
cv_5 = trainControl(method = "cv", number = 5)
View(Data)
hit_elnet = train(
Data[,9] ~ ., data = Data,
method = "glmnet",
trControl = cv_5
)
Data[,9]
Data[,-1]
hit_elnet = train(
Data[,9] ~ Data[,-1],
method = "glmnet",
trControl = cv_5
)
hit_elnet = train(
Data$y ~ ., data=Data,
method = "glmnet",
trControl = cv_5
)
attach(Data)
hit_elnet = train(
y ~ ., data=Data,
method = "glmnet",
trControl = cv_5
)
View(hit_elnet)
hit_elnet
cv_EN = train(
y ~ ., data=Data,
method = "glmnet",
trControl = cv_5,
tuneLength = 10
)
cv_EN
cv_5 = trainControl(method = "cv", number = 5)
cv_EN = train(
y ~ ., data=Data,
method = "glmnet",
trControl = cv_5,
tuneLength = 100
)
cv_EN
for (i in 3:6){
cv = trainControl(method = "cv", number = i)
cv_EN = train(
y ~ ., data=Data,
method = "glmnet",
trControl = cv,
tuneLength = 100
)
print(cv_EN)
}
for (i in 3:6){
cv = trainControl(method = "cv", number = i)
cv_EN = train(
y ~ ., data=Data,
method = "glmnet",
trControl = cv,
tuneLength = 100
)
print(cv_EN)
}
print("hello")
print("hello") ; c(1,2,3)
c(1,2,3)
rm(list=ls())
install.packages("readstata13")
read.dta13("/Users/admin/Downloads/MAGANewsData.dta")
library(readstata13)
read.dta13("/Users/admin/Downloads/MAGANewsData.dta")
data = read.dta13("/Users/admin/Downloads/MAGANewsData.dta")
View(data)
View(data)
data$maganews1998
columns(data)
names(data)
ifelse(data$maganews1998==0&data$maganews2000==0, data$traite==1)
ifelse(data$maganews1998==0&data$maganews2000==0, data$traite==1, NULL)
ifelse(data$maganews1998==0&data$maganews2000==0, data$traite==1, data$traite==0)
data$traite = 1
ifelse(data$maganews1998==0&data$maganews2000==0, data$traite=1, data$traite=0)
ifelse(data$maganews1998==0&data$maganews2000==0, 1, 0)
data$traite = ifelse(data$maganews1998==0&data$maganews2000==1, 1, 0)
data$controle = ifelse(data$maganews1998==0&data$maganews2000==0, 1, 0)
View(data)
sum(data$traite)
sum(data$traite, na.rm=TRUE)
sum(data$controle, na.rm=TRUE)
666+5422
names(data)
mean(data$maganews1998, na.rm=TRUE)
mean(data$maganews2000, na.rm=TRUE)
mean(data$maganews2003, na.rm=TRUE)
data$diff_reppresfv2p = data$reppresfv2p1996-data$reppresfv2p2000
data[is.na(data$traite)==FALSE,]
dim(data[data$traite==1|data$controle==1,])
dim(data[data$traite==1,])
sum(data$traite, na.rm=TRUE)
View(data)
test = data[data$traite==1,]
View(test)
test = data[data$traite==1&data$traite!=NA,]
View(test)
test = data[data$traite==1 & is.na(data$traite) == FALSE,]
test2=data[data$traite==1 & is.na(data$traite) == FALSE|data$traite==0 & is.na(data$traite) == FALSE,]
View(test2)
test2=data[data$traite==1 & is.na(data$traite) == FALSE|data$controle==1 & is.na(data$controle) == FALSE,]
data_rt = data[data$traite==1 & is.na(data$traite) == FALSE|data$controle==1 & is.na(data$controle) == FALSE,]
data_res = data[data$traite==1 & is.na(data$traite) == FALSE|data$controle==1 & is.na(data$controle) == FALSE,]
data_res$diff_reppresfv2p = data_res$reppresfv2p1996-data_res$reppresfv2p2000
View(data_res)
data_res$traite+data_res$controle
lm(diff_reppresfv2p ~ traite, data=data_res)
fd = lm(diff_reppresfv2p ~ traite, data=data_res)
summary(fd)
data_did = data_res[,c("traite, controle","reppresfv2p1996","reppresfv2p2000")]
data_did = data_res[,c("traite", "controle","reppresfv2p1996","reppresfv2p2000")]
View(data_did)
data_did = data_res[,c("traite","reppresfv2p1996","reppresfv2p2000")]
View(data)
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
library(reshape2)
library(tidyr)
gather(data_did, key=data_did[,3:4])
test = gather(data_did, key=data_did[,3:4])
View(test)
test = gather(data_did)
View(test)
test = gather(data_did, value=data_did[,3:4])
View(test)
test = gather(data_did, key, value, -town, -traite)
View(test)
test = gather(data_did, year, reppresfv2p, -town, -traite)
substr(data_did$year, -4)
substr(data_did$year, -4, -1)
data_did$year
substr(test$year, -4, -1)
test$year
substr(test$year, -1, -5)
substr(test$year, 1,5)
substr(test$year, -4, -1)
substr(test$year, 10, -1)
substr(test$year, 8, 12)
substr(test$year, 15, 18)
substr(test$year, 12, 18)
test = gather(data_did, year_200, reppresfv2p, -town, -traite)
test = gather(data_did, year_2000, reppresfv2p, -town, -traite)
ifelse(substr(test$year_2000, 12, 18)=="1996", 0, 1)
test$year_2000 = ifelse(substr(test$year_2000, 12, 18)=="1996", 0, 1)
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
data_did$year_2000 = ifelse(substr(test$year_2000, 12, 18)=="1996", 0, 1)
data_did$traite_year = data_did$traite*data_did$year
lm(reppresfv2p ~ year_2000 + traite + traite_year, data=data_did)
did = lm(reppresfv2p ~ year_2000 + traite + traite_year, data=data_did)
summary(did)
did = lm(reppresfv2p ~ year_2000 + traite + traite_year -1, data=data_did)
summary(did)
did = lm(reppresfv2p ~ year_2000*traite, data=data_did)
summary(did)
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
data_did$year_2000 = ifelse(substr(test$year_2000, 12, 18)=="1996", 0, 1)
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
data_did$year_2000 = ifelse(substr(data_did$year_2000, 12, 18)=="1996", 0, 1)
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
data_did$year_2000 = ifelse(substr(data_did$year_2000, 12, 18)=="1996", 0, 1)
did = lm(reppresfv2p ~ year_2000*traite, data=data_did)
summary(did)
summary(fd)
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
data_did = gather(data_did, year_2000, reppresfv2p, -town, traite)
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
View(data_res)
data_did$year_traite = data_did$year_2000*data_did$traite
did = lm(reppresfv2p ~ year_2000 + traite + year_traite, data=data_did)
did = lm(reppresfv2p ~ year_2000 + traite + year_traite, data=data_did)
data_did$year_traite = data_did$year_2000*data_did$traite
data_did = data_res[,c("town","traite","reppresfv2p1996","reppresfv2p2000")]
data_did = gather(data_did, year_2000, reppresfv2p, -town, -traite)
data_did$year_2000 = ifelse(substr(data_did$year_2000, 12, 18)=="1996", 0, 1)
data_did$year_traite = data_did$year_2000*data_did$traite
did = lm(reppresfv2p ~ year_2000 + traite + year_traite, data=data_did)
summary(did)
data_res = data[data$traite==1 & is.na(data$traite) == FALSE|data$controle==1 & is.na(data$controle) == FALSE,]
data_res$diff_reppresfv2p = data_res$reppresfv2p2000-data_res$reppresfv2p1996
fd = lm(diff_reppresfv2p ~ traite, data=data_res)
summary(fd)
View(data_res)
names(data_res)
var = c("pop","hs","hsp","college","male","black","hisp","empl","unempl", "married","income", "urban")
paste0(var,"1990")
var_1990 = paste0(var, "1990")
var_2000 = paste0(var, "2000")
for (i in var_1990){ print(i)}
taux_var = paste0("croissance_", var)
j=1
for (i in taux_var){
data_res$taux_var = (data_res[,var_2000[j]]-data_res[,var_1990[j]])/data_res[,var_1990[j]]
j = j+1
}
names(data_res)
j=1
for (i in taux_var){
data_res$i = (data_res[,var_2000[j]]-data_res[,var_1990[j]])/data_res[,var_1990[j]]
j = j+1
}
j=1
for (i in taux_var){
var = i
data_res$var = (data_res[,var_2000[j]]-data_res[,var_1990[j]])/data_res[,var_1990[j]]
j = j+1
}
data_res
names(data_res)
temps = seq(0, 15)
infected = c(NA,NA,NA,31,82,216,299,269,242,190,125,81,52,25,22,7)
donnees = data.frame(time=temps, I=infected, origin="donnees")
rm(list=ls())
temps = seq(0, 15)
infected = c(NA,NA,NA,31,82,216,299,269,242,190,125,81,52,25,22,7)
donnees = data.frame(time=temps, I=infected, origin="donnees")
View(donnees)
rm(list=ls())
require(zoo)
require(tseries)
library(urca)
path <- "/Users/admin/Desktop/valeur2019_04_17 (1)"
data <- read.csv("valeurs_mensuelles.csv",sep=";",header=F)
titre <- data[1,2]
titre
setwd(path)
data <- read.csv("valeurs_mensuelles.csv",sep=";",header=F)
titre <- data[1,2]
titre
serie <- as.numeric(as.character(data[4:length(data$V2),2]))
serie <- zoo(serie)
plot(serie,main="Série simple")
serie2 <- log(serie)
plot(serie2,main="Série log")
desaison <- serie2 - lag(serie2,-12)
plot(desaison)
acf(desaison,lag.max = 50)
pacf(desaison,lag.max = 50)
M <- matrix(rep(diag(12),30),ncol=12,byrow=T, nrow=350)
E <- matrix(1:350,ncol=1)
X <- cbind(E,M[,-1]) # tendance + dummy
datareg <- cbind(as.matrix(serie2),M[1:350,-1]) #M[1:350,-1]
data<-as.data.frame(datareg)
reg=lm(serie2~.,data=data)
summary(reg)
essai = reg$residuals
plot(essai,type="l")
acf(essai, lag.max=50)
pacf(essai,lag.max=50)
debut <- essai[1:250]
plot(debut,type="l")
fin <- essai[251:350]
plot(fin,type='l')
abs1 <- 1:250
abs2 <- 251:350
reg1 <- lm(debut~abs1)
reg2 <- lm(fin~abs2)
essai2 <- c(reg1$residuals,reg2$residuals)
plot(essai2,type="l")
new_serie <- zoo(essai2)
plot(new_serie)
acf(new_serie,lag.max = 50)
pacf(new_serie,lag.max = 50)
path <- "/Users/admin/Desktop/ENSAE/2A/S2/Séries temporelles/Projet/TimeSeries/Electricite"
setwd(path)
data <- read.csv("valeurs_mensuelles.csv",sep=";",header=F)
titre <- data[1,2]
titre
serie <- as.numeric(as.character(data[4:length(data$V2),2]))
serie <- zoo(serie)
plot(serie,main="Série simple")
serie2 <- log(serie)
plot(serie2,main="Série log")
M <- matrix(rep(diag(12),30),ncol=12,byrow=T, nrow=350)
E <- matrix(1:350,ncol=1)
X <- cbind(E,M[,-1]) # tendance + dummy
datareg <- cbind(as.matrix(serie2),M[1:350,-1]) #M[1:350,-1]
data<-as.data.frame(datareg)
reg=lm(serie2~.,data=data)
summary(reg)
essai = reg$residuals
plot(essai,type="l")
debut <- essai[1:200]
plot(debut,type="l")
fin <- essai[201:350]
plot(fin,type='l')
abs1 <- 1:200
abs2 <- 201:350
reg1 <- lm(debut~abs1)
reg2 <- lm(fin~abs2)
essai2 <- c(reg1$residuals,reg2$residuals)
plot(essai2,type="l")
new_serie <- zoo(essai2)
plot(new_serie)
acf(new_serie,lag.max = 50)
pacf(new_serie,lag.max = 50)
abs1 <- (1:200)^2
abs2 <- 201:350
reg1 <- lm(debut~abs1)
reg2 <- lm(fin~abs2)
essai2 <- c(reg1$residuals,reg2$residuals)
plot(essai2,type="l")
debut <- essai[1:150]
plot(debut,type="l")
fin <- essai[151:350]
plot(fin,type='l')
abs1 <- (1:150)^2
abs2 <- 151:350
reg1 <- lm(debut~abs1)
reg2 <- lm(fin~abs2)
essai2 <- c(reg1$residuals,reg2$residuals)
plot(essai2,type="l")
new_serie <- zoo(essai2)
plot(new_serie)
acf(new_serie,lag.max = 50)
pacf(new_serie,lag.max = 50)
abs1 <- (1:150)
abs2 <- 151:350
reg1 <- lm(debut~abs1)
reg2 <- lm(fin~abs2)
essai2 <- c(reg1$residuals,reg2$residuals)
plot(essai2,type="l")
new_serie <- zoo(essai2)
plot(new_serie)
acf(new_serie,lag.max = 50)
pacf(new_serie,lag.max = 50)
path <- "/Users/admin/Desktop/ENSAE/2A/S2/Séries temporelles/Projet/TimeSeries/Electricite"
setwd(path)
data <- read.csv("valeurs_mensuelles.csv",sep=";",header=F)
titre <- data[1,2]
titre
serie <- as.numeric(as.character(data[4:length(data$V2),2]))
serie <- zoo(serie)
plot(serie,main="Série simple")
serie2 <- log(serie)
plot(serie2,main="Série log")
desaison <- serie2 - lag(serie2,-12)
M <- matrix(rep(diag(12),30),ncol=12,byrow=T, nrow=350)
E <- matrix(1:350,ncol=1)
X <- cbind(E,M[,-1]) # tendance + dummy
datareg <- cbind(as.matrix(serie2),M[1:350,-1]) #M[1:350,-1]
data<-as.data.frame(datareg)
reg=lm(serie2~.,data=data)
summary(reg)
essai = reg$residuals
plot(essai,type="l")
plot(essai,type="l")
acf(essai, lag.max=50)
pacf(essai,lag.max=50)
debut <- essai[1:230]
plot(debut,type="l")
fin <- essai[231:350]
plot(fin,type='l')
abs1 <- (1:230)
abs2 <- 231:350
reg1 <- lm(debut~abs1)
reg2 <- lm(fin~abs2)
essai2 <- c(reg1$residuals,reg2$residuals)
plot(essai2,type="l")
new_serie <- zoo(essai2)
plot(new_serie)
acf(new_serie,lag.max = 50)
pacf(new_serie,lag.max = 50)
